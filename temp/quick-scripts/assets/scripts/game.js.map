{"version":3,"sources":["game.js"],"names":["cc","Class","extends","Component","properties","planePrefab","default","type","Prefab","scoreDisplay","Label","bulletPrefab","interval","time_lapsed","enemyPrefab","interval_enemy","is_over","score","begin","string","node","setPosition","v2","screen_width","setAnchorPoint","p","instantiate","addChild","macro","MAX_ZINDEX","getComponent","game","plane","on","Node","EventType","TOUCH_MOVE","fly","off","TOUCH_START","event","delta","getDelta","x","y","gainScore","onLoad","manager","director","getCollisionManager","enabled","size","view","getVisibleSize","width","zIndex","start","fire","bl","getPosition","spawnEnemy","en","gameover","update","dt","Math","random"],"mappings":"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","file":"game.js","sourceRoot":"../../../../assets/scripts","sourcesContent":["// Learn cc.Class:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/class.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/class.html\n// Learn Attribute:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/reference/attributes.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/reference/attributes.html\n// Learn life-cycle callbacks:\n//  - [Chinese] http://docs.cocos.com/creator/manual/zh/scripting/life-cycle-callbacks.html\n//  - [English] http://www.cocos2d-x.org/docs/creator/en/scripting/life-cycle-callbacks.html\n\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        planePrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n\n        scoreDisplay: {\n            default: null,\n            type: cc.Label\n        },\n\n        bulletPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        interval: 0,\n        time_lapsed: 0,\n\n        enemyPrefab: {\n            default: null,\n            type: cc.Prefab\n        },\n        interval_enemy: 0,\n        is_over: false,\n        score: 0,\n    },\n\n    begin: function () {\n        this.is_over = false;\n        this.score = 0;\n        this.scoreDisplay.string = 'Score: ' + this.score;\n        this.scoreDisplay.node.setPosition(cc.v2(-this.screen_width / 2 + 10, 325));\n        this.scoreDisplay.node.setAnchorPoint(0, 0.5);\n\n        var p = cc.instantiate(this.planePrefab);\n        this.node.addChild(p, cc.macro.MAX_ZINDEX);\n        p.getComponent('plane').game = this;\n        this.plane = p;\n\n        this.node.on(cc.Node.EventType.TOUCH_MOVE, this.fly, this);\n        this.node.off(cc.Node.EventType.TOUCH_START, this.begin, this);\n    },\n\n    fly: function (event) {\n        var delta = event.getDelta();\n        this.plane.x += delta.x;\n        this.plane.y += delta.y;\n    },\n\n    gainScore: function () {\n        this.score += 1;\n        this.scoreDisplay.string = 'Score: ' + this.score;\n    },\n    // LIFE-CYCLE CALLBACKS:\n\n    onLoad () {\n        var manager = cc.director.getCollisionManager();\n        manager.enabled = true;\n        let size = cc.view.getVisibleSize();\n        this.screen_width = size.width;\n\n        this.scoreDisplay.node.zIndex = cc.macro.MAX_ZINDEX;\n        this.begin();\n\n    },\n\n    start () {\n\n    },\n\n    fire: function() {\n        var bl = cc.instantiate(this.bulletPrefab);\n        this.node.addChild(bl);\n        bl.getComponent('bullet').game = this;\n        bl.setPosition(this.plane.getPosition());\n    },\n\n    spawnEnemy: function() {\n        var en = cc.instantiate(this.enemyPrefab);\n        en.getComponent('enemy').game = this;\n        this.node.addChild(en);\n    },\n\n    gameover: function () {\n        this.is_over = true;\n        this.node.off(cc.Node.EventType.TOUCH_MOVE, this.fly, this);\n        this.node.on(cc.Node.EventType.TOUCH_START, this.begin, this);\n\n        this.scoreDisplay.node.setPosition(cc.v2(0, 0));\n        this.scoreDisplay.node.setAnchorPoint(0.5, 0.5);\n    },\n\n    update (dt) {\n        if (!this.is_over) {\n            // 发射子弹\n            this.time_lapsed += dt;\n            if (this.time_lapsed > this.interval) {\n                this.time_lapsed = 0.8;\n                this.fire();\n            }\n\n            // 产生敌机\n            this.interval_enemy -= dt;\n            if (this.interval_enemy < 0) {\n                // this.interval_enemy = Math.random() * 2 + 0.5;\n                this.interval_enemy = Math.random() * 2 + 0.0;\n                this.spawnEnemy();\n                this.spawnEnemy();\n                this.spawnEnemy();\n            }\n        }\n    },\n});\n"]}